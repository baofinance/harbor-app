# Sail Tokens Subgraph - PRODUCTION (PnL + price history only)
specVersion: 0.0.8
schema:
  file: ./schema.graphql
dataSources:
  # ETH/fxUSD (prod)
  - kind: ethereum
    name: SailGenesis_ETH_fxUSD
    network: mainnet
    source:
      address: "0xC9df4f62474Cf6cdE6c064DB29416a9F4f27EBdC"
      abi: Genesis
      startBlock: 24049488
    mapping:
      kind: ethereum/events
      apiVersion: 0.0.7
      language: wasm/assemblyscript
      entities:
        - SailGenesisUser
        - UserList
        - UserSailPosition
        - CostBasisLot
      abis:
        - name: Genesis
          file: ./abis/Genesis.json
        - name: WrappedPriceOracle
          file: ./abis/WrappedPriceOracle.json
        - name: ChainlinkAggregator
          file: ./abis/ChainlinkAggregator.json
      eventHandlers:
        - event: Deposit(indexed address,indexed address,uint256)
          handler: handleDeposit
        - event: Withdraw(indexed address,indexed address,uint256)
          handler: handleWithdraw
        - event: GenesisEnds()
          handler: handleGenesisEnd
      file: ./src/genesisPnL.ts

  - kind: ethereum
    name: Minter_ETH_fxUSD
    network: mainnet
    source:
      address: "0xd6E2F8e57b4aFB51C6fA4cbC012e1cE6aEad989F"
      abi: Minter
      startBlock: 24049488
    mapping:
      kind: ethereum/events
      apiVersion: 0.0.7
      language: wasm/assemblyscript
      entities:
        - UserSailPosition
        - CostBasisLot
        - SailTokenMintEvent
        - SailTokenRedeemEvent
        - SailTokenPricePoint
        - HourlyPriceSnapshot
        - PriceTracker
      abis:
        - name: Minter
          file: ./abis/Minter.json
        - name: WrappedPriceOracle
          file: ./abis/WrappedPriceOracle.json
        - name: ChainlinkAggregator
          file: ./abis/ChainlinkAggregator.json
        - name: ERC20
          file: ./abis/ERC20.json
      eventHandlers:
        - event: MintLeveragedToken(indexed address,indexed address,uint256,uint256)
          handler: handleMintLeveragedToken
        - event: RedeemLeveragedToken(indexed address,uint256,uint256)
          handler: handleRedeemLeveragedToken
      file: ./src/minterPnL.ts

  # BTC/fxUSD (prod)
  - kind: ethereum
    name: SailGenesis_BTC_fxUSD
    network: mainnet
    source:
      address: "0x42cc9a19b358a2A918f891D8a6199d8b05F0BC1C"
      abi: Genesis
      startBlock: 24049375
    mapping:
      kind: ethereum/events
      apiVersion: 0.0.7
      language: wasm/assemblyscript
      entities:
        - SailGenesisUser
        - UserList
        - UserSailPosition
        - CostBasisLot
      abis:
        - name: Genesis
          file: ./abis/Genesis.json
        - name: WrappedPriceOracle
          file: ./abis/WrappedPriceOracle.json
        - name: ChainlinkAggregator
          file: ./abis/ChainlinkAggregator.json
      eventHandlers:
        - event: Deposit(indexed address,indexed address,uint256)
          handler: handleDeposit
        - event: Withdraw(indexed address,indexed address,uint256)
          handler: handleWithdraw
        - event: GenesisEnds()
          handler: handleGenesisEnd
      file: ./src/genesisPnL.ts

  - kind: ethereum
    name: Minter_BTC_fxUSD
    network: mainnet
    source:
      address: "0x33e32ff4d0677862fa31582CC654a25b9b1e4888"
      abi: Minter
      startBlock: 24049375
    mapping:
      kind: ethereum/events
      apiVersion: 0.0.7
      language: wasm/assemblyscript
      entities:
        - UserSailPosition
        - CostBasisLot
        - SailTokenMintEvent
        - SailTokenRedeemEvent
        - SailTokenPricePoint
        - HourlyPriceSnapshot
        - PriceTracker
      abis:
        - name: Minter
          file: ./abis/Minter.json
        - name: WrappedPriceOracle
          file: ./abis/WrappedPriceOracle.json
        - name: ChainlinkAggregator
          file: ./abis/ChainlinkAggregator.json
        - name: ERC20
          file: ./abis/ERC20.json
      eventHandlers:
        - event: MintLeveragedToken(indexed address,indexed address,uint256,uint256)
          handler: handleMintLeveragedToken
        - event: RedeemLeveragedToken(indexed address,uint256,uint256)
          handler: handleRedeemLeveragedToken
      file: ./src/minterPnL.ts

  # BTC/stETH (prod)
  - kind: ethereum
    name: SailGenesis_BTC_stETH
    network: mainnet
    source:
      address: "0xc64Fc46eED431e92C1b5e24DC296b5985CE6Cc00"
      abi: Genesis
      startBlock: 24049273
    mapping:
      kind: ethereum/events
      apiVersion: 0.0.7
      language: wasm/assemblyscript
      entities:
        - SailGenesisUser
        - UserList
        - UserSailPosition
        - CostBasisLot
      abis:
        - name: Genesis
          file: ./abis/Genesis.json
        - name: WrappedPriceOracle
          file: ./abis/WrappedPriceOracle.json
        - name: ChainlinkAggregator
          file: ./abis/ChainlinkAggregator.json
      eventHandlers:
        - event: Deposit(indexed address,indexed address,uint256)
          handler: handleDeposit
        - event: Withdraw(indexed address,indexed address,uint256)
          handler: handleWithdraw
        - event: GenesisEnds()
          handler: handleGenesisEnd
      file: ./src/genesisPnL.ts

  - kind: ethereum
    name: Minter_BTC_stETH
    network: mainnet
    source:
      address: "0xF42516EB885E737780EB864dd07cEc8628000919"
      abi: Minter
      startBlock: 24049273
    mapping:
      kind: ethereum/events
      apiVersion: 0.0.7
      language: wasm/assemblyscript
      entities:
        - UserSailPosition
        - CostBasisLot
        - SailTokenMintEvent
        - SailTokenRedeemEvent
        - SailTokenPricePoint
        - HourlyPriceSnapshot
        - PriceTracker
      abis:
        - name: Minter
          file: ./abis/Minter.json
        - name: WrappedPriceOracle
          file: ./abis/WrappedPriceOracle.json
        - name: ChainlinkAggregator
          file: ./abis/ChainlinkAggregator.json
        - name: ERC20
          file: ./abis/ERC20.json
      eventHandlers:
        - event: MintLeveragedToken(indexed address,indexed address,uint256,uint256)
          handler: handleMintLeveragedToken
        - event: RedeemLeveragedToken(indexed address,uint256,uint256)
          handler: handleRedeemLeveragedToken
      file: ./src/minterPnL.ts


